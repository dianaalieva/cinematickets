{"version":3,"sources":["../js/block_films.js"],"names":["API_TOKEN","cinemaCatalogWrapper","document","getElementById","innerHTML","renderFilmBlock","title","posterUrl","id","filmLink","createElement","href","filmWrapper","classList","add","filmPoster","src","alt","filmModal","filmName","textContent","filmDescription","append","getBlockFilmsData","getTopFilms","answer","json","data","requests","filmsLayout","Map","films","forEach","film","nameRu","posterUrlPreview","filmId","filmBlock","description","set","push","Promise","resolve","getFilmDetails","filmData","all","i","filmLayout","console","error"],"mappings":"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","sourcesContent":["const API_TOKEN='08b36bd4-4230-423f-9857-06ae35b0098d';\r\nconst cinemaCatalogWrapper = document.getElementById('cinema-catalog');\r\ncinemaCatalogWrapper.innerHTML='';\r\n\r\nconst renderFilmBlock = (title,posterUrl,id)=>{ \r\n    const filmLink=document.createElement('a');\r\n    filmLink.href=`/single/?id=${id}`;\r\n\r\n    const filmWrapper=document.createElement('div');\r\n    filmWrapper.classList.add('catalog__image','catalog__image5');\r\n\r\n    const filmPoster=document.createElement('img');\r\n    filmPoster.src=posterUrl;\r\n    filmPoster.alt='постер к фильму';\r\n\r\n    const filmModal=document.createElement('div');\r\n    filmModal.classList.add('catalog__image-modal');\r\n\r\n    const filmName=document.createElement('p');\r\n    filmName.classList.add('catalog__image-name');\r\n    filmName.textContent=title;\r\n\r\n    const filmDescription=document.createElement('p');\r\n    filmDescription.classList.add('catalog__image-lorem');\r\n    filmDescription.textContent='Loading...';\r\n\r\n    filmModal.append(filmName,filmDescription);\r\n    filmWrapper.append(filmLink);\r\n    filmLink.append(filmPoster,filmModal);\r\n    \r\n    return[filmWrapper,filmDescription];\r\n};\r\nconst getBlockFilmsData=async()=>{\r\n    try{\r\n        const answer = await getTopFilms();\r\n        const data = await answer.json();\r\n        const requests=[];\r\n        const filmsLayout=new Map();\r\n\r\n        data.films.forEach(async(film) => { \r\n            const[filmBlock,description] = renderFilmBlock(film.nameRu,film.posterUrlPreview,film.filmId);\r\n            filmsLayout.set(film.filmId,filmBlock);\r\n\r\n            requests.push(new Promise(async(resolve)=>{\r\n                try{\r\n                    const answer=await getFilmDetails(film.filmId);\r\n                    const filmData=await answer.json();\r\n\r\n                    description.textContent=filmData.filmDescription;\r\n                    if(!filmData.filmDescription){\r\n                        filmsLayout.delete(film.filmId);\r\n                    };\r\n                }catch(error){\r\n                }\r\n                resolve();\r\n            }));\r\n        });\r\n        await Promise.all(requests);\r\n\r\n        let i=0;\r\n        for(const[,filmLayout] of filmsLayout){\r\n            cinemaCatalogWrapper.append(filmLayout);\r\n\r\n            i++;\r\n            if(i===9){\r\n                break;\r\n            };\r\n        };\r\n           \r\n    } catch(error){\r\n        console.error(error);\r\n    }\r\n    \r\n}\r\ngetBlockFilmsData();\r\n\r\n"],"file":"block_films.js"}