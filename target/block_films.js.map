{"version":3,"sources":["../js/block_films.js"],"names":["API_TOKEN","cinemaCatalogWrapper","document","getElementById","renderFilmBlock","title","posterUrl","filmId","filmLink","createElement","href","filmWrapper","classList","add","filmPoster","src","alt","filmModal","filmName","textContent","filmDescription","append","getBlockFilmsData","getTopFilms","answer","json","data","requests","filmsLayout","Map","films","forEach","film","i","nameRu","posterUrlPreview","set","push","Promise","resolve","reject","setTimeout","getFilmDetails","filmData","description","all","innerHTML","filmLayout","console","error"],"mappings":"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","sourcesContent":["const API_TOKEN='08b36bd4-4230-423f-9857-06ae35b0098d';\r\nconst cinemaCatalogWrapper = document.getElementById('cinema-catalog');\r\n\r\nconst renderFilmBlock = (title,posterUrl,filmId)=>{ \r\n    const filmLink=document.createElement('a');\r\n    filmLink.href=`/single/single.html?id=${filmId}`;\r\n\r\n    const filmWrapper=document.createElement('div');\r\n    filmWrapper.classList.add('catalog__image','catalog__image5');\r\n\r\n    const filmPoster=document.createElement('img');\r\n    filmPoster.src=posterUrl;\r\n    filmPoster.alt='постер к фильму';\r\n\r\n    const filmModal=document.createElement('div');\r\n    filmModal.classList.add('catalog__image-modal');\r\n\r\n    const filmName=document.createElement('p');\r\n    filmName.classList.add('catalog__image-name');\r\n    filmName.textContent=title;\r\n\r\n    const filmDescription=document.createElement('p');\r\n    filmDescription.classList.add('catalog__image-lorem');\r\n    filmDescription.textContent='Loading...';\r\n\r\n    filmModal.append(filmName,filmDescription);\r\n    filmWrapper.append(filmLink);\r\n    filmLink.append(filmPoster,filmModal);\r\n    \r\n    return[filmWrapper,filmDescription];\r\n};\r\nconst getBlockFilmsData=async()=>{\r\n    try{\r\n        const answer = await getTopFilms();\r\n        const data = await answer.json();\r\n        const requests=[];\r\n        const filmsLayout=new Map();\r\n\r\n        data.films.forEach(async(film,i) => { \r\n            const[filmWrapper,filmDescription] = renderFilmBlock(film.nameRu,film.posterUrlPreview,film.filmId);\r\n            filmsLayout.set(film.filmId,filmWrapper);\r\n\r\n            requests.push(new Promise((resolve,reject)=>{\r\n                setTimeout(async()=>{\r\n                    try{\r\n                        const answer=await getFilmDetails(film.filmId);\r\n                        const filmData=await answer.json();\r\n    \r\n                        filmDescription.textContent=filmData.description;\r\n                        if(!filmData.description){\r\n                            filmsLayout.delete(film.filmId);\r\n                        };\r\n                    }catch(error){\r\n                    }\r\n                    resolve();\r\n                },i*100);\r\n               \r\n            }));\r\n        });\r\n        await Promise.all(requests);\r\n        \r\n        cinemaCatalogWrapper.innerHTML='';\r\n        let i=0;\r\n        for(const[,filmLayout] of filmsLayout){\r\n            cinemaCatalogWrapper.append(filmLayout);\r\n\r\n            i++;\r\n            if(i===9){\r\n                break;\r\n            };\r\n        };\r\n           \r\n    } catch(error){\r\n        console.error(error);\r\n    }\r\n    \r\n}\r\ngetBlockFilmsData();\r\n\r\n"],"file":"block_films.js"}