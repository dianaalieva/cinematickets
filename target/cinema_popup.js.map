{"version":3,"sources":["../js/cinema_popup.js"],"names":["prizeForm","document","getElementById","openButton","querySelector","closeButton","nameInputWrapper","emailInputWrapper","prizeSelect","POPUP_ERROR_CLASS","POPUP_FOCUS_CLASS","popupToggle","classList","toggle","clearErrors","input","remove","initializeField","popupInput","pInput","getElementsByTagName","popupErrorText","pRemError","innerText","pRemFocus","value","addEventListener","add","focus","getValue","setError","error","field1","field2","fields","onclick","reset","forEach","el","errorText","event","preventDefault","popupValue","emailValue","test","console","log","data","name","email","free","url","URL","search","URLSearchParams","toString","fetch"],"mappings":"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","sourcesContent":["const prizeForm=document.getElementById('prize-popup');\r\nconst openButton=document.querySelector('#popup-open');\r\nconst closeButton=document.querySelector('#popup-close');\r\nconst nameInputWrapper=document.querySelector('.form__popup');\r\nconst emailInputWrapper=document.querySelector('.form__popup2');\r\nconst prizeSelect=document.querySelector('#prize');\r\n\r\nconst POPUP_ERROR_CLASS='form__popup-error';\r\nconst POPUP_FOCUS_CLASS='form__popup-focus';\r\n\r\n\r\nfunction popupToggle(){\r\n    prizeForm.classList.toggle('hidden');\r\n}\r\nfunction clearErrors(input){\r\n    input.classList.remove(POPUP_ERROR_CLASS);\r\n}\r\nfunction initializeField(popupInput){\r\n    const pInput= popupInput.getElementsByTagName('input')[0];\r\n    const popupErrorText= popupInput.querySelector('.form__popup-error-msg');\r\n\r\n    function pRemError(){\r\n        popupInput.classList.remove(POPUP_ERROR_CLASS);\r\n        popupErrorText.innerText='';\r\n    };\r\n    pRemError();\r\n    function pRemFocus(){\r\n        popupInput.classList.remove(POPUP_FOCUS_CLASS);\r\n        pInput.value='';\r\n    };\r\n    \r\n\r\n    pInput.addEventListener('focus',function(){\r\n        popupInput.classList.add(POPUP_FOCUS_CLASS);\r\n        \r\n    });\r\n    pInput.addEventListener('input',function(){\r\n        pRemError();\r\n    });\r\n    pInput.addEventListener('blur',function(){\r\n        if(!pInput.value){\r\n            pRemFocus();\r\n        };\r\n    });\r\n\r\n    return{\r\n        focus(){\r\n            pInput.focus() \r\n        },\r\n        getValue(){\r\n            return pInput.value\r\n        },\r\n        setError(error){\r\n            popupErrorText.innerText=error;\r\n            popupInput.classList.add(POPUP_ERROR_CLASS);\r\n        },\r\n    };\r\n};\r\n\r\nconst field1= initializeField(nameInputWrapper);\r\nconst field2= initializeField(emailInputWrapper);\r\nconst fields=[field1,field2];\r\n\r\nopenButton.onclick=function(){\r\n    popupToggle();\r\n    field1.focus();\r\n};\r\n\r\ncloseButton.onclick=function(){\r\n    popupToggle();\r\n    document.getElementById('prize-popup').reset();\r\n    [nameInputWrapper,emailInputWrapper].forEach(el=>{\r\n        clearErrors(el);\r\n        const errorText=el.querySelector('.form__popup-error-msg');\r\n        errorText.innerText='';\r\n    });\r\n};\r\n\r\nprizeForm.addEventListener('submit', function(event){\r\n    event.preventDefault();\r\n    fields.forEach(el=>{\r\n        const popupValue=el.getValue();\r\n\r\n        if (!popupValue){\r\n           el.setError('не заполнено');\r\n           el.focus();\r\n           return;\r\n        }\r\n    });\r\n\r\n    const emailValue=field2.getValue();\r\n\r\n    if(!/^[\\w]{3,20}@[a-z 0-9]{4,8}|.[a-z]{2,3}$/.test(emailValue)){\r\n        field2.setError('некорректный email');\r\n        field2.focus();\r\n    };\r\n    console.log(prizeSelect,3)\r\n    if(prizeSelect.value===\"none\"){\r\n        prizeSelect.classList.add(POPUP_ERROR_CLASS);\r\n    };\r\n    const data ={\r\n        name:nameInputWrapper.value,\r\n        email:emailInputWrapper.value,\r\n        free:prizeSelect.value,\r\n    };\r\n\r\n    const url=new URL('http://inno-ijl.ru/multystub/stc-21-03/feedback');\r\n    url.search=new URLSearchParams(data).toString();\r\n\r\n    fetch(url.toString());\r\n});\r\n\r\n"],"file":"cinema_popup.js"}